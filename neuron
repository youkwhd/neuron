#!/usr/bin/julia

include("lib/Neuron.jl")

network =
    Neuron.Network([
        Neuron.Layer(2),
        Neuron.Layer(2),
        Neuron.Layer(1),
    ])

dataset = [
    # XOR
    [[0, 0], [0]],
    [[0, 1], [1]],
    [[1, 0], [1]],
    [[1, 1], [0]],

    # OR
    # [[0, 0], [0]],
    # [[0, 1], [1]],
    # [[1, 0], [1]],
    # [[1, 1], [1]],

    # AND
    # [[0, 0], [0]],
    # [[0, 1], [0]],
    # [[1, 0], [0]],
    # [[1, 1], [1]],

    # NAND
    # [[0, 0], [1]],
    # [[0, 1], [1]],
    # [[1, 0], [1]],
    # [[1, 1], [0]],

    # NOR
    # [[0, 0], [1]],
    # [[0, 1], [0]],
    # [[1, 0], [0]],
    # [[1, 1], [0]],
]


Neuron.train(network, dataset)

for data in dataset
    result = Neuron.predict(network, convert(Vector{Float64}, data[1]))
    println(data[1], " ~", last(network.layers).neurons[1], " => ", result[1])
end
